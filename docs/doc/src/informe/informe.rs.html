<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Source of the Rust file `src&#x2F;informe.rs`."><meta name="keywords" content="rust, rustlang, rust-lang"><title>informe.rs - source</title><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../../ayu.css" disabled ><script id="default-settings" ></script><script src="../../storage.js"></script><script src="../../crates.js"></script><noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../../favicon.svg"><style type="text/css">#crate-search{background-image:url("../../down-arrow.svg");}</style></head><body class="rustdoc source"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../../informe/index.html'><div class='logo-container rust-logo'><img src='../../rust-logo.png' alt='logo'></div></a></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="18" height="18" alt="Pick another theme!" src="../../brush.svg"></button><div id="theme-choices" role="menu"></div></div><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../../settings.html" title="settings"><img width="18" height="18" alt="Change settings" src="../../wheel.svg"></a></div></form></nav><section id="main" class="content"><div class="example-wrap"><pre class="line-numbers"><span id="1"> 1</span>
<span id="2"> 2</span>
<span id="3"> 3</span>
<span id="4"> 4</span>
<span id="5"> 5</span>
<span id="6"> 6</span>
<span id="7"> 7</span>
<span id="8"> 8</span>
<span id="9"> 9</span>
<span id="10">10</span>
<span id="11">11</span>
<span id="12">12</span>
<span id="13">13</span>
<span id="14">14</span>
<span id="15">15</span>
<span id="16">16</span>
<span id="17">17</span>
<span id="18">18</span>
<span id="19">19</span>
<span id="20">20</span>
<span id="21">21</span>
<span id="22">22</span>
<span id="23">23</span>
<span id="24">24</span>
<span id="25">25</span>
<span id="26">26</span>
<span id="27">27</span>
<span id="28">28</span>
<span id="29">29</span>
<span id="30">30</span>
<span id="31">31</span>
<span id="32">32</span>
<span id="33">33</span>
<span id="34">34</span>
<span id="35">35</span>
<span id="36">36</span>
<span id="37">37</span>
<span id="38">38</span>
<span id="39">39</span>
<span id="40">40</span>
<span id="41">41</span>
<span id="42">42</span>
<span id="43">43</span>
<span id="44">44</span>
<span id="45">45</span>
<span id="46">46</span>
<span id="47">47</span>
<span id="48">48</span>
<span id="49">49</span>
<span id="50">50</span>
<span id="51">51</span>
<span id="52">52</span>
<span id="53">53</span>
<span id="54">54</span>
<span id="55">55</span>
<span id="56">56</span>
<span id="57">57</span>
<span id="58">58</span>
<span id="59">59</span>
<span id="60">60</span>
<span id="61">61</span>
<span id="62">62</span>
<span id="63">63</span>
<span id="64">64</span>
<span id="65">65</span>
<span id="66">66</span>
<span id="67">67</span>
<span id="68">68</span>
<span id="69">69</span>
<span id="70">70</span>
<span id="71">71</span>
<span id="72">72</span>
</pre><pre class="rust"><code><span class="doccomment">//! Informe</span>
<span class="doccomment">//! ---</span>
<span class="doccomment">//! Este informe puede ser leido tanto en [PDF](https://camidvorkin.github.io/concurrentes-alglobo2/informe.pdf) (gracias a `pandoc`) como en [HTML](https://camidvorkin.github.io/concurrentes-alglobo2/doc/informe/index.html) (gracias a `rustdoc`)</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! Para documentación especifica del código fuente que excede a este informe se puede consultar la [documentación de la aplicación](https://camidvorkin.github.io/concurrentes-alglobo2/doc/alglobo/index.html) (en inglés).</span>
<span class="doccomment">//!</span>
<span class="doccomment">//! ## Trabajo Práctico</span>
<span class="doccomment">//! </span>
<span class="doccomment">//! ### Introducción</span>
<span class="doccomment">//! </span>
<span class="doccomment">//! En este trabajo práctico, se desarrolló la continuación de Alglobo.com desarrollada en la primera étapa de la materia. En este caso, se debe resolver un sistema de procesamiento de pagos con la complejidad de que se trata de un sistema distribuido, es decir que los pagos no solo se deberan ejecutar concurrentemente pero ademas se deben enviar via Sokets.</span>
<span class="doccomment">//! Por otro lado, se suma la complejidad de que tanto los agentes a los que se les envia el dinero como la plataforma de alglobo puede fallar y el programa debe poder continuar sin problema. </span>
<span class="doccomment">//! </span>
<span class="doccomment">//! ### Ejecución</span>
<span class="doccomment">//! </span>
<span class="doccomment">//! Por un lado se debe levantar el sistema de alglobo que sera el encargado de resolver todo el procesamiento de pagos y enviarselo a cada uno de los agentes en cuestión. Para levantarlo: `cargo run --bin alglobo`</span>
<span class="doccomment">//! Por otro lado, se debe levantar el sistema de agentes(Banco, Aereolinea y Hotel) que se encargaran de recibir y procesar el pago. Para levantarlo: `cargo run --bin agents`</span>
<span class="doccomment">//! TOdo que se puede agregar un archivo</span>
<span class="doccomment">//! </span>
<span class="doccomment">//! ### Supuestos</span>
<span class="doccomment">//! </span>
<span class="doccomment">//! - Al tratar las transacciones con un two-phase lockig, se asume que si un nodo de alglobo falla:</span>
<span class="doccomment">//!    - Antes de finalizar la primera fase (no termina el PREPARE), el siguiente nodo de alglobo comienza desde el principio.</span>
<span class="doccomment">//!     - Despues de finalizar la primera fase (imprime el PREPARE pero no el COMMIT/ABORT), el siguiente nodo de alglobo ABORTA esa transacción.</span>
<span class="doccomment">//!     - Durante la segunda fase(no logra imprimir COMMIT/ABORT), el siguiente nodo de alglobo ABORTA esa transacción.</span>
<span class="doccomment">//!     - Tras finalizar la segunda fase, significa que se completo la transacción y el siguiente nodo podra seguir con la siguiente transacción.</span>
<span class="doccomment">//! - Una vez que finalizan las lineas del archivo, se cierran ambos sistemas.</span>
<span class="doccomment">//! </span>
<span class="doccomment">//! ### Implementación</span>
<span class="doccomment">//! </span>
<span class="doccomment">//! #### Alglobo</span>
<span class="doccomment">//! </span>
<span class="doccomment">//! ##### Coordinador</span>
<span class="doccomment">//! </span>
<span class="doccomment">//! El sistema de AlGlobo.com es de misión crítica y por lo tanto debe mantener varias réplicas en línea listas para continuar el proceso, aunque solo una de ellas se encuentra activa al mismo tiempo. </span>
<span class="doccomment">//! Una vez que se enciende el sistema, la terminal se queda a la espera de que el usuario ingrese un número, el identificador de la réplica, para poder simular la salida de servicio de la misma, mostrando que el sistema en su conjunto sigue funcionando.</span>
<span class="doccomment">//! Esto se resuelve con el **algoritmo Ring**. Para resolver con este algormitmo, fue importante que cada réplica conozca el identificador de la siguiente réplica y el identificador de la réplica lider(la replica que se mantiene activa y resuelve el procesamiento de pagos). </span>
<span class="doccomment">//! Al conocer el identificador, el mismo va a poder conocer la dirección a la cual enviar los mensajes ya que las direcciones se obtienen a partir de la siguiente función: </span>
<span class="doccomment">//! ``` rust</span>
<span class="doccomment">//! pub fn id_to_ctrladdr(id: usize) -&gt; SocketAddr {</span>
<span class="doccomment">//!     let port = (1100 + id) as u16;</span>
<span class="doccomment">//!     SocketAddr::from(([127, 0, 0, 1], port))</span>
<span class="doccomment">//! }</span>
<span class="doccomment">//! ```</span>
<span class="doccomment">//! </span>
<span class="doccomment">//! Todas estas direcciones se van a utilizar para enviar y recibir mensajes via Socket UDP en torno a resolver el problema de disponibilidad del servicio:</span>
<span class="doccomment">//! 1. Cuando un proceso nota que el coordinador fallo, tras un TIMEOUT especifico que le indica que no recibe información del lider, este arma un mensaje ELECTION que contiene su identificador y envía este mensaje al siguiente nodo de la red. Este primer mensaje se puede ver en el método `find_new()` en `src/leader_election.rs`.</span>
<span class="doccomment">//! 2. El proceso que recibe el mensaje, agrega su identificador al final del mensaje y lo envía al siguiente nodo de la red. Esta recursión se puede ver en el método `safe_send_next` en `src/leader_election.rs`.</span>
<span class="doccomment">//! 3. Cuando el proceso original que noto que el lider fallo recibe el mensaje que originalmente inicio él, busca entre los diferentes ids encolados aquel con identificador más alto, para así decidir quien es el lider. Arma un nuevo mensaje, pero esta vez del tipo COORDINATOR y lo envia a su sucesor. </span>
<span class="doccomment">//! 4. Cuando el mensaje finaliza la circulación, se elimina el anillo.</span>
<span class="doccomment">//! </span>
<span class="doccomment">//! ##### Procesamiento de pagos</span>
<span class="doccomment">//! </span>
<span class="doccomment">//! El sistema de alglobo debe encargarse de resolver todo el procesamiento de pagos y enviarselo a cada uno de los agentes en cuestión. Para ello se abre una conexión UDP para cada uno de los procesos. </span>
<span class="doccomment">//! En el caso de ser lider, el proceso se encargara de leer una linea a la vez del archivo pasado por párametro o el default `src/prices.csv`. Cada línea del archivo va a contener 3 números, siendo el primero el precio a cobrar al Banco, el segundo el de la Aereolinea y el tercero del Hotel.</span>
<span class="doccomment">//! De manera concurrente y via TCP se les envia a los tres agentes el precio a cobrar. Este envio se va a resolver con **commit en dos fases**:</span>
<span class="doccomment">//! - Fase 1: El coordinador escribe el mensaje de PREPARE y lo broadcastea a los tres agentes. Luego broadcastea al resto de los procesos que se encuentra en la fase PREPARE para la transacción corresponde.</span>
<span class="doccomment">//! - Fase 2: A partir de las respuestas obtenidas por los agentes, el coordinador envia el mensaje de COMMIT o ABORT (de haber al menos un agente que responda ABORT, el proceso entero se debera abortar) a los tres agentes y luego lo broadcastea a todos los procesos.</span>
<span class="doccomment">//! De esta forma garantizamos que las transacciones sean serializables, por lo que si se cae el coordinador, la replica que tome su lugar va a tener la información necesaria para terminar su trabajo y continuarlo sin notar cambios en el funcionamiento del sistema.</span>
<span class="doccomment">//! </span>
<span class="doccomment">//! #### Agentes</span>
<span class="doccomment">//! </span>
<span class="doccomment">//! Cosas a decir:</span>
<span class="doccomment">//! - la terminal los escucha pa morir</span>
<span class="doccomment">//! - commit/abort/prepare</span>
<span class="doccomment">//! - TCP</span>
<span class="doccomment">//! </span>
<span class="doccomment">//! ### Conclusión</span>
<span class="doccomment">//! </span>
<span class="doccomment">//! TODO: @jdisan</span>
<span class="doccomment">//! </span>
<span class="kw">fn</span> <span class="ident">main</span>() {}
</code></pre></div>
</section><section id="search" class="content hidden"></section><div id="rustdoc-vars" data-root-path="../../" data-current-crate="informe" data-search-index-js="../../search-index.js" data-search-js="../../search.js"></div>
    <script src="../../main.js"></script><script src="../../source-script.js"></script><script src="../../source-files.js"></script>
</body></html>